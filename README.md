# **PySpark Films and Actors**
### Самостоятельное задание №3 — «Фильмы и актёры»  
**Spark SQL** · временные таблицы (temporary views) · Google Colab / PySpark

---

### Описание задания

Вам даны три набора данных:

- `movies` — информация о фильмах  
- `actors` — информация об актёрах  
- `movie_actors` — связи «какой актёр в каком фильме»

Необходимо объединить данные и выполнить аналитические запросы с использованием **Spark SQL** через временные таблицы (temporary views).

Скачать исходные CSV/архив: `https://disk.yandex.ru/d/EJU5clkFkhWklA`

---

### Структура данных

### Таблица `movies`

| Поле | Описание |
|---|---|
| `movie_id` | ID фильма |
| `title` | Название фильма |
| `genre` | Жанр фильма |
| `release_date` | Дата выхода (формат `YYYY-MM-DD`) |
| `budget` | Бюджет фильма (числовое значение) |

### Таблица `actors`

| Поле | Описание |
|---|---|
| `actor_id` | ID актёра |
| `name` | Имя актёра |
| `birth_date` | Дата рождения (формат `YYYY-MM-DD`) |
| `country` | Страна актёра |

### Таблица `movie_actors`

| Поле | Описание |
|---|---|
| `movie_id` | ID фильма |
| `actor_id` | ID актёра |

---

### Окружение и инструменты

- **Среда:** Google Colab (рекомендуется) или локальная машина с PySpark.  
- **Инструменты:** PySpark, Spark SQL.  
- **Формат отчёта:** Markdown (этот файл) + отдельный notebook / скрипт с выполнением SQL (код). 

---

### Последовательность выполнения (строго)

1. Скачать CSV/архив и положить файлы в рабочую директорию.  
2. Загрузить CSV в Spark DataFrame: `movies_df`, `actors_df`, `movie_actors_df`.  
3. Привести `release_date` и `birth_date` к типу `DATE`.  
4. Привести `budget` к числовому типу (DOUBLE/DECIMAL).  
5. Зарегистрировать temporary views:
   - `movies_df.createOrReplaceTempView("movies")`
   - `actors_df.createOrReplaceTempView("actors")`
   - `movie_actors_df.createOrReplaceTempView("movie_actors")`
6. Выполнить SQL-запросы (ниже).  
7. Вывести результаты (`show()` / сохранить в CSV).

---

### SQL запросы

1. Найдите топ-5 жанров по количеству фильмов.
2. Найдите актера с наибольшим количеством фильмов.
3. Подсчитайте средний бюджет фильмов по жанрам.
4. Найдите фильмы, в которых снялось более одного актера из одной страны.
